<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>bumit club</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" href="http://js.arcgis.com/3.10/js/esri/css/esri.css"/>
    <script src="http://js.arcgis.com/3.10/"></script>
    <script>
        var map;
        require([
            "esri/map", "esri/layers/GeoRSSLayer", "esri/InfoTemplate",
            "dojo/parser", "dojo/_base/array", "dojo/dom-style",
            "dijit/layout/BorderContainer", "dijit/layout/ContentPane", "dojo/domReady!"
        ], function(
                Map, GeoRSSLayer, InfoTemplate,
                parser, arrayUtils, domStyle
                ) {
            map = new esri.Map("map",{
                basemap: "oceans",
                center: [-110.399, 45.226],
                zoom: 7
            });

            // create layout dijits
            parser.parse();

            var georssUrl = "http://bumit.sensorflare.com/items.rss";
            // other examples of GeoRSS feeds:
            // var georssUrl = "http://geocommons.com/overlays/188692.atom"; // U.S. Breweries in 2009 http://geocommons.com/overlays/188692
            // var georssUrl = "http://geocommons.com/overlays/116926.atom"; // S.F. and East Bay Breweries http://geocommons.com/overlays/116926
            var georss = new GeoRSSLayer(georssUrl);
            georss.on("load", function() {
                domStyle.set("loading", "display", "none");
                // create an info template
                var template = new InfoTemplate("${name}", "${description}");
                // set the info template for the feature layers that make up the GeoRSS layer
                // the GeoRSS layer contains one feature layer for each geometry type
                var layers = georss.getFeatureLayers();
                arrayUtils.forEach(layers, function(l) {
                    l.setInfoTemplate(template);
                });
            });
            map.addLayer(georss);
        });
    </script>
</head>
<body>
<h4>These are the items available:</h4>

<div th:each="tweet:${items}">

    <p><span th:text="${tweet.text}">Text</span></p>
    &mdash;<span th:text="${tweet.name}">Name</span> (@<span th:text="${tweet.handle}">Handle</span>)

    <img th:src="${tweet.imageUrl}"/>

    <p><span th:text="${tweet.latitude}">Lat</span> /
        <span th:text="${tweet.longitude}">Long</span></p>
</div>

<div style="clear:both; height: 500px; width: 500px;">
    <div id="map"
         data-dojo-type="dijit/layout/ContentPane"
         data-dojo-props="region:'center'"
         style="clear:both; height: 100%; width: 100%;">
        <div id="meta">
            <span id="loading"><img src="http://dl.dropbox.com/u/2654618/loading_black.gif"/></span>

            <h3>Display GeoRSS on a map</h3>
            <br/>
            The map displays a simple GeoRSS file with points, lines and polygons.
        </div>
    </div>
</div>

</body>
</html>